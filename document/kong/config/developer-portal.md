# Developer Portal

## 개요

Kong Developer Portal은 개발자들이 API를 발견하고 사용할 수 있는 웹 인터페이스를 제공합니다. 개발자 등록, 인증, 애플리케이션 관리 등의 기능을 포함합니다.

### 주요 특징

- **개발자 포털 GUI**: 웹 기반 사용자 인터페이스
- **개발자 포털 API**: RESTful API 엔드포인트
- **인증 시스템**: 다양한 인증 방법 지원
- **이메일 알림**: 개발자 등록 및 승인 프로세스 자동화
- **애플리케이션 관리**: 개발자 애플리케이션 등록 및 관리

## 기본 포털 설정

| 설정     | 설명                               | 기본값 |
| -------- | ---------------------------------- | ------ |
| `portal` | 개발자 포털 스위치를 활성화합니다. | `off`  |

### 포털 활성화 시 기능

- Kong이 `portal_gui_listen` 주소에서 Dev Portal 인터페이스와 읽기 전용 API를 노출합니다
- Admin API에서 자산을 관리할 수 있는 엔드포인트를 제공합니다
- `portal_auth`와 함께 활성화되면 Admin API와 Dev Portal API에서 개발자 계정 관리 엔드포인트를 제공합니다

## 포털 GUI 설정

### 기본 GUI 설정

| 설정                  | 설명                                                                                                                    | 기본값                                 |
| --------------------- | ----------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| `portal_gui_listen`   | Kong이 Developer Portal GUI를 노출할 주소의 쉼표로 구분된 목록입니다.                                                   | `["0.0.0.0:8003", "0.0.0.0:8446 ssl"]` |
| `portal_gui_protocol` | `portal_gui_host`와 함께 사용하여 Kong Proxy 노드의 조회 또는 로드 밸런서 주소를 구성하는 데 사용되는 프로토콜입니다.   | `http`                                 |
| `portal_gui_host`     | `portal_gui_protocol`과 함께 사용하여 Kong Proxy 노드의 조회 또는 로드 밸런서 주소를 구성하는 데 사용되는 호스트입니다. | `127.0.0.1:8003`                       |

### GUI 프로토콜 예시

- `http`
- `https`

### GUI 호스트 형식

| 형식                | 예시                    | 설명           |
| ------------------- | ----------------------- | -------------- |
| `<IP>:<PORT>`       | `127.0.0.1:8003`        | IP 주소와 포트 |
| `<HOSTNAME>`        | `portal_api.domain.tld` | 도메인 이름    |
| `<HOSTNAME>/<PATH>` | `dev-machine/dev-285`   | 도메인과 경로  |

### CORS 및 서브도메인 설정

| 설정                        | 설명                                                                                                                                                                                         | 기본값 |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_cors_origins`       | Access-Control-Allow-Origin 헤더에 허용되는 도메인의 쉼표로 구분된 목록입니다.                                                                                                               | -      |
| `portal_gui_use_subdomains` | 기본적으로 Kong Portal은 요청 경로의 첫 번째 네임스페이스를 사용하여 워크스페이스를 결정합니다. 이 옵션을 켜면 Kong Portal이 요청 URL에 서브도메인으로 워크스페이스가 포함되기를 기대합니다. | `off`  |

### CORS 설정 예시

- **도메인 목록**: `portal_cors_origins = http://localhost:8003, https://localhost:8004`
- **단일 도메인**: `portal_cors_origins = http://localhost:8003`
- **모든 도메인**: `portal_cors_origins = *`

### 서브도메인 사용 예시

- **비활성화 (off)**: `<scheme>://<HOSTNAME>/<WORKSPACE>/<PATH>` → `http://kong-portal.com/example-workspace/index`
- **활성화 (on)**: `<scheme>://<WORKSPACE>.<HOSTNAME>` → `http://example-workspace.kong-portal.com/index`

### SSL 인증서 설정

| 설정                      | 설명                                                           | 기본값 |
| ------------------------- | -------------------------------------------------------------- | ------ |
| `portal_gui_ssl_cert`     | SSL이 활성화된 `portal_gui_listen` 값에 대한 SSL 인증서입니다. | -      |
| `portal_gui_ssl_cert_key` | SSL이 활성화된 `portal_gui_listen` 값에 대한 SSL 키입니다.     | -      |

### SSL 인증서 설정 방법

SSL 인증서는 다음 값 중 하나로 구성할 수 있습니다:

- **인증서의 절대 경로**
- **인증서 내용**
- **base64로 인코딩된 인증서 내용**

### 로그 설정

| 설정                    | 설명                                                                                        | 기본값                       |
| ----------------------- | ------------------------------------------------------------------------------------------- | ---------------------------- |
| `portal_gui_access_log` | Portal GUI 액세스 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 로깅이 비활성화됩니다. | `logs/portal_gui_access.log` |
| `portal_gui_error_log`  | Portal GUI 오류 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 로깅이 비활성화됩니다.   | `logs/portal_gui_error.log`  |

## 포털 API 설정

### 기본 API 설정

| 설정                | 설명                                                                  | 기본값                                 |
| ------------------- | --------------------------------------------------------------------- | -------------------------------------- |
| `portal_api_listen` | Kong이 Developer Portal API를 노출할 주소의 쉼표로 구분된 목록입니다. | `["0.0.0.0:8004", "0.0.0.0:8447 ssl"]` |
| `portal_api_url`    | Kong Developer Portal 노드의 조회 또는 로드 밸런서 주소입니다.        | `http://0.0.0.0:8004`                  |

### API URL 형식

`portal_api_url`은 다음 형식으로 구성할 수 있습니다:

```
<scheme>://<IP / HOSTNAME>(:<PORT>(/<PATH>))
```

**예시**:

- `<scheme>://<IP>:<PORT>` → `portal_api_url = http://127.0.0.1:8003`
- SSL `<scheme>://<HOSTNAME>` → `portal_api_url = https://portal_api.domain.tld`
- `<scheme>://<HOSTNAME>/<PATH>` → `portal_api_url = http://dev-machine/dev-285`

### API SSL 인증서 설정

| 설정                      | 설명                                                           | 기본값 |
| ------------------------- | -------------------------------------------------------------- | ------ |
| `portal_api_ssl_cert`     | SSL이 활성화된 `portal_api_listen` 값에 대한 SSL 인증서입니다. | -      |
| `portal_api_ssl_cert_key` | SSL이 활성화된 `portal_api_listen` 값에 대한 SSL 키입니다.     | -      |

### API 로그 설정

| 설정                    | 설명                                                                                        | 기본값                       |
| ----------------------- | ------------------------------------------------------------------------------------------- | ---------------------------- |
| `portal_api_access_log` | Portal API 액세스 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 로깅이 비활성화됩니다. | `logs/portal_api_access.log` |
| `portal_api_error_log`  | Portal API 오류 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 로깅이 비활성화됩니다.   | `logs/portal_api_error.log`  |

## 레거시 지원

| 설정               | 설명                                                                                              | 기본값 |
| ------------------ | ------------------------------------------------------------------------------------------------- | ------ |
| `portal_is_legacy` | 이 값을 `on`으로 설정하면 모든 새 포털이 기본적으로 레거시 렌더링 시스템을 사용하여 렌더링됩니다. | `off`  |

## 애플리케이션 등록 인증

| 설정              | 설명                                                                                                                         | 기본값        |
| ----------------- | ---------------------------------------------------------------------------------------------------------------------------- | ------------- |
| `portal_app_auth` | 개발자 포털 애플리케이션 등록 인증 제공자 및 전략입니다. `application_registration` 플러그인을 활성화하려면 설정해야 합니다. | `kong-oauth2` |

## 기본 포털 인증 설정

### 인증 플러그인 설정

| 설정          | 설명                                                       | 기본값 |
| ------------- | ---------------------------------------------------------- | ------ |
| `portal_auth` | Developer Portal에 적용할 인증 플러그인 이름을 지정합니다. | -      |

### 지원되는 인증 플러그인

- **Basic Authentication**: `portal_auth = basic-auth`
- **OIDC Authentication**: `portal_auth = openid-connect`

### 비밀번호 복잡성 설정

| 설정                              | 설명                                                                             | 기본값 |
| --------------------------------- | -------------------------------------------------------------------------------- | ------ |
| `portal_auth_password_complexity` | `portal_auth = basic-auth`일 때 Kong Portal 비밀번호에 필요한 규칙을 정의합니다. | -      |

### 비밀번호 복잡성 규칙

#### 사전 설정 규칙

모든 `kong-preset` 값은 비밀번호가 다음 카테고리 중 최소 3개에서 문자를 포함하도록 요구합니다:

- 대문자 (A-Z)
- 소문자 (a-z)
- Base-10 숫자 (0-9)
- 특수 문자 (예: &, $, #, %)

**지원되는 사전 설정 규칙**:

- `min_8`: 최소 길이 8
- `min_12`: 최소 길이 12
- `min_20`: 최소 길이 20

**예시**:

```json
portal_auth_password_complexity = { "kong-preset": "min_8" }
```

#### 사용자 정의 규칙

지원되는 키워드: `min`, `max`, `passphrase`

**예시**:

```json
portal_auth_password_complexity = { "min": "disabled,24,11,9,8" }
```

### 인증 플러그인 구성

| 설정               | 설명                                                                          | 기본값 |
| ------------------ | ----------------------------------------------------------------------------- | ------ |
| `portal_auth_conf` | Developer Portal 인증에 적용할 플러그인 구성 객체를 JSON 형식으로 지정합니다. | -      |

**예시 (basic-auth)**:

```json
portal_auth_conf = { "hide_credentials": true }
```

### 로그인 시도 제한

| 설정                         | 설명                                                                                                                       | 기본값 |
| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_auth_login_attempts` | 사용자가 비밀번호를 재설정하기 전에 Dev Portal에 로그인을 시도할 수 있는 횟수입니다. 0(기본값)은 무제한 시도를 허용합니다. | `0`    |

**참고**: 0보다 큰 값은 `basic-auth`로 보호된 Dev Portal에만 영향을 줍니다.

### 세션 구성

| 설정                  | 설명                                                           | 기본값 |
| --------------------- | -------------------------------------------------------------- | ------ |
| `portal_session_conf` | Kong Portal에서 사용하는 Session 플러그인의 구성을 지정합니다. | -      |

**예시**:

```json
portal_session_conf = {
  "cookie_name": "portal_session",
  "secret": "changeme",
  "storage": "kong"
}
```

## 개발자 관리 설정

### 자동 승인 설정

| 설정                  | 설명                                                                                                                                                 | 기본값 |
| --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_auto_approve` | `on`으로 설정하면 개발자가 등록을 완료한 후 자동으로 "승인됨"으로 표시됩니다. Kong Manager 또는 Admin API를 통해 여전히 액세스를 취소할 수 있습니다. | `off`  |

### 토큰 만료 설정

| 설정               | 설명                                                   | 기본값          |
| ------------------ | ------------------------------------------------------ | --------------- |
| `portal_token_exp` | Dev Portal 비밀번호 재설정 토큰의 만료 시간(초)입니다. | `21600` (6시간) |

### 이메일 인증 설정

| 설정                        | 설명                                                                                                                                                                   | 기본값 |
| --------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_email_verification` | 활성화되면 개발자가 등록 시 계정을 인증하기 위한 이메일을 받습니다. 자동 승인이 활성화되어 있어도 개발자는 계정을 인증할 때까지 Developer Portal을 사용할 수 없습니다. | `off`  |

**참고**: 이 기능을 사용하려면 SMTP를 켜야 합니다.

## 기본 포털 SMTP 구성

### 이메일 알림 설정

| 설정                               | 설명                                                                                                                              | 기본값 |
| ---------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_invite_email`              | 활성화되면 Kong 관리자가 Kong Manager의 초대 버튼을 사용하여 개발자를 Dev Portal에 초대할 수 있습니다.                            | `on`   |
| `portal_access_request_email`      | 활성화되면 개발자가 Dev Portal에 액세스를 요청할 때 `smtp_admin_emails`로 지정된 Kong 관리자가 이메일을 받습니다.                 | `on`   |
| `portal_approved_email`            | 활성화되면 개발자가 Dev Portal 액세스가 승인되었을 때 이메일을 받습니다.                                                          | `on`   |
| `portal_reset_email`               | 활성화되면 개발자가 Dev Portal에서 비밀번호 재설정 플로우를 사용할 수 있고 비밀번호 재설정 지침이 포함된 이메일을 받습니다.       | `on`   |
| `portal_reset_success_email`       | 활성화되면 개발자가 Dev Portal 계정 비밀번호를 성공적으로 재설정한 후 이메일을 받습니다.                                          | `on`   |
| `portal_application_status_email`  | 활성화되면 개발자가 애플리케이션 서비스 요청의 상태가 변경될 때 이메일을 받습니다.                                                | `off`  |
| `portal_application_request_email` | 활성화되면 개발자가 애플리케이션을 통해 서비스에 액세스를 요청할 때 `smtp_admin_emails`로 지정된 Kong 관리자가 이메일을 받습니다. | `off`  |

### 이메일 헤더 설정

| 설정                     | 설명                                                                    | 기본값 |
| ------------------------ | ----------------------------------------------------------------------- | ------ |
| `portal_emails_from`     | 모든 Dev Portal 이메일에 포함되는 From 헤더의 이름과 이메일 주소입니다. | -      |
| `portal_emails_reply_to` | 포털 이메일의 Reply-To 헤더 이메일 주소입니다.                          | -      |

**예시**:

- `portal_emails_from = Your Name <example@example.com>`
- `portal_emails_reply_to = example@example.com`

### 관리자 이메일 설정

| 설정                       | 설명                                                                                                                      | 기본값 |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------- | ------ |
| `portal_smtp_admin_emails` | 포털 알림을 받을 관리자 이메일의 쉼표로 구분된 목록입니다. Admin API를 통해 워크스페이스별로 동적으로 설정할 수 있습니다. | -      |

**예시**: `admin1@example.com, admin2@example.com`

**참고**: 설정되지 않으면 `smtp_admin_emails`가 사용됩니다.

## 이메일 템플릿 예시

### 초대 이메일

```
제목: Dev Portal <WORKSPACE_NAME> 액세스 초대

안녕하세요 개발자님!

%s에서 Dev Portal 계정을 생성하도록 초대받았습니다.
계정을 생성하려면 `<DEV_PORTAL_URL/register>`를 방문하세요.
```

### 액세스 요청 이메일

```
제목: Dev Portal <WORKSPACE NAME> 액세스 요청

안녕하세요 관리자님!

<DEVELOPER NAME>이 <WORKSPACE_NAME>에 대한 Dev Portal 액세스를 요청했습니다.
이 요청을 검토하려면 <KONG_MANAGER_URL/developers/requested>를 방문하세요.
```

### 승인 이메일

```
제목: Dev Portal 액세스 승인됨

안녕하세요 개발자님!
<WORKSPACE_NAME>에 대한 액세스가 승인되었습니다.
로그인하려면 <DEV PORTAL URL/login>을 방문하세요.
```

### 비밀번호 재설정 이메일

```
제목: Dev Portal <WORKSPACE_NAME> 비밀번호 재설정 지침

안녕하세요 개발자님,

아래 링크를 클릭하여 Dev Portal 비밀번호를 재설정하세요.

<DEV_PORTAL_URL/reset?token=12345>

이 링크는 <portal_reset_token_exp> 후에 만료됩니다.

이 요청을 하지 않았다면 위 링크를 클릭하여 계정을 보호하세요.
```

### 비밀번호 변경 성공 이메일

```
제목: Dev Portal 비밀번호 변경 성공

안녕하세요 개발자님,
<DEV_PORTAL_URL>의 Dev Portal 비밀번호가 변경되었음을 알려드립니다.

새 자격 증명으로 로그인하려면 아래 링크를 클릭하세요.

<DEV_PORTAL_URL>
```

### 애플리케이션 상태 변경 이메일

```
제목: Dev Portal 애플리케이션 요청 <REQUEST_STATUS> (<DEV_PORTAL_URL>)

안녕하세요 개발자님,
<DEV_PORTAL_URL>의 Developer Portal 계정에서 애플리케이션 액세스 요청이 <REQUEST_STATUS>되었음을 알려드립니다.

애플리케이션: <APPLICATION_NAME>
서비스: <SERVICE_NAME>

액세스가 승인되면 또 다른 이메일을 받게 됩니다.
```

### 애플리케이션 요청 이메일

```
제목: <DEVELOPER_EMAIL>의 Dev Portal (<DEV_PORTAL_URL>) 서비스 액세스 요청

안녕하세요 관리자님,

<DEVELOPER NAME> (<DEVELOPER_EMAIL>)이 <DEV_PORTAL_URL>에 대한 애플리케이션 액세스를 요청했습니다.

요청된 워크스페이스: <WORKSPACE_NAME>
요청된 애플리케이션: <APPLICATION_NAME>
요청된 서비스: <SERVICE_NAME>

이 요청을 검토하려면 <KONG_MANAGER_URL/WORKSPACE_NAME/applications/APPLICATION_ID#requested>를 방문하세요.
```

## 보안 고려사항

### SSL/TLS 설정

- **인증서 관리**: SSL 인증서를 안전하게 관리하세요
- **키 보안**: 개인 키를 안전한 위치에 저장하세요
- **인증서 갱신**: 인증서 만료를 모니터링하고 정기적으로 갱신하세요

### 인증 보안

- **비밀번호 정책**: 강력한 비밀번호 복잡성 규칙을 설정하세요
- **로그인 제한**: 무차별 대입 공격을 방지하기 위해 로그인 시도 제한을 설정하세요
- **세션 관리**: 안전한 세션 구성과 정기적인 세션 갱신을 설정하세요

### 이메일 보안

- **SMTP 설정**: 안전한 SMTP 서버를 사용하세요
- **이메일 검증**: 개발자 이메일 주소 검증을 활성화하세요
- **관리자 알림**: 중요한 이벤트에 대한 관리자 알림을 설정하세요

## 운영 권장사항

### 모니터링

- **로그 모니터링**: 포털 액세스 및 오류 로그를 정기적으로 검토하세요
- **성능 모니터링**: 포털 응답 시간과 사용량을 모니터링하세요
- **보안 모니터링**: 의심스러운 활동을 모니터링하세요

### 백업 및 복구

- **구성 백업**: 포털 구성을 정기적으로 백업하세요
- **데이터 백업**: 개발자 계정 및 애플리케이션 데이터를 백업하세요
- **재해 복구**: 재해 복구 절차를 정기적으로 테스트하세요

### 사용자 관리

- **자동 승인**: 필요에 따라 자동 승인을 활성화하세요
- **이메일 알림**: 적절한 이메일 알림을 설정하세요
- **사용자 교육**: 개발자에게 포털 사용법을 교육하세요
