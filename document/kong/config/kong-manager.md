# Kong Manager

## 개요

Kong Manager는 Kong Enterprise의 Admin GUI입니다. Kong을 구성하고 관리할 수 있는 웹 애플리케이션으로, 보안이 유지되어야 합니다.

### 주요 특징

- **웹 기반 관리 인터페이스**: Kong 설정 및 관리를 위한 직관적인 웹 UI
- **인증 시스템**: 다양한 인증 방법 지원
- **사용자 정의 가능**: 헤더, 푸터, 로그인 배너 등 커스터마이징 가능
- **보안 기능**: SSL/TLS, CSP 헤더, 비밀번호 복잡성 등

## 기본 Kong Manager 설정

### 리스너 설정

| 설정                | 설명                                                                                                           | 기본값                                 |
| ------------------- | -------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| `admin_gui_listen`  | Kong이 Kong Manager를 노출할 주소와 포트의 쉼표로 구분된 목록입니다. 각 쌍에 대해 접미사를 지정할 수 있습니다. | `["0.0.0.0:8002", "0.0.0.0:8445 ssl"]` |
| `admin_gui_url`     | Kong Manager의 주소(조회 또는 로드 밸런서)의 쉼표로 구분된 목록입니다.                                         | -                                      |
| `admin_gui_path`    | Kong Manager가 제공되는 경로 접두사를 사용자 정의할 수 있습니다.                                               | `/`                                    |
| `admin_gui_api_url` | Admin API가 HTTP 또는 HTTPS 트래픽을 수락하는 호스트, 포트, 경로로 구성된 URI의 계층적 부분입니다.             | -                                      |

### URL 형식

#### admin_gui_url 형식

```
<scheme>://<IP / HOSTNAME>[:<PORT>][<PATH>][, <scheme>://<IP / HOSTNAME>[:<PORT>][<PATH>]]
```

**예시**:

- `http://127.0.0.1:8003`
- `https://kong-admin.test`
- `http://dev-machine`
- `http://127.0.0.1:8003, https://example.com/manager`

#### admin_gui_path 형식 규칙

| 규칙                                                                | 설명                          |
| ------------------------------------------------------------------- | ----------------------------- |
| 경로는 `/`로 시작해야 함                                            | ✅ `/manager`                 |
| 경로는 `/`로 끝나지 않아야 함 (단, `/` 제외)                        | ✅ `/manager`, ❌ `/manager/` |
| 경로는 문자, 숫자, 하이픈(-), 언더스코어(\_), 슬래시(/)만 포함 가능 | ✅ `/kong-manager`            |
| 경로는 연속된 슬래시를 포함하지 않아야 함                           | ❌ `//`, `///`                |

**예시**:

- `/`
- `/manager`
- `/kong-manager`
- `/kong/manager`

## SSL/TLS 설정

### SSL 인증서 설정

| 설정                      | 설명                                                          | 기본값            |
| ------------------------- | ------------------------------------------------------------- | ----------------- |
| `admin_gui_ssl_cert`      | SSL이 활성화된 `admin_gui_listen` 값에 대한 SSL 인증서입니다. | -                 |
| `admin_gui_ssl_cert_key`  | SSL이 활성화된 `admin_gui_listen` 값에 대한 SSL 키입니다.     | -                 |
| `admin_gui_ssl_protocols` | Kong Manager에서 지원하는 TLS 버전을 정의합니다.              | `TLSv1.2 TLSv1.3` |

### SSL 인증서 설정 방법

SSL 인증서는 다음 값 중 하나로 구성할 수 있습니다:

- **인증서의 절대 경로**
- **인증서 내용**
- **base64로 인코딩된 인증서 내용**

## 로그 설정

| 설정                   | 설명                                                                                                 | 기본값                      |
| ---------------------- | ---------------------------------------------------------------------------------------------------- | --------------------------- |
| `admin_gui_access_log` | Kong Manager 액세스 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 액세스 로그가 비활성화됩니다. | `logs/admin_gui_access.log` |
| `admin_gui_error_log`  | Kong Manager 오류 로그의 절대 또는 상대 경로입니다. `off`로 설정하면 오류 로그가 비활성화됩니다.     | `logs/admin_gui_error.log`  |

## 인증 설정

### 기본 인증 설정

| 설정                            | 설명                                                                                      | 기본값            |
| ------------------------------- | ----------------------------------------------------------------------------------------- | ----------------- |
| `admin_gui_auth`                | 사용할 인증 플러그인을 지정하여 Kong Manager 액세스를 보호합니다.                         | -                 |
| `admin_gui_auth_conf`           | `admin_gui_auth`에 지정된 인증 플러그인의 구성을 지정합니다.                              | -                 |
| `admin_gui_auth_header`         | Admin API가 Kong Admin 사용자를 식별하려고 시도할 HTTP 요청 헤더의 이름을 정의합니다.     | `Kong-Admin-User` |
| `admin_gui_auth_login_attempts` | 사용자가 Kong Manager에 로그인을 시도할 수 있는 횟수입니다. 0은 무제한 시도를 허용합니다. | `0`               |

### 지원되는 인증 플러그인

| 플러그인             | 설명                                   |
| -------------------- | -------------------------------------- |
| `basic-auth`         | Basic Authentication 플러그인          |
| `ldap-auth-advanced` | LDAP Authentication 플러그인           |
| `openid-connect`     | OpenID Connect Authentication 플러그인 |

### 인증 플러그인 구성 예시

**basic-auth 예시**:

```json
admin_gui_auth_conf = { "hide_credentials": true }
```

## 비밀번호 복잡성 설정

| 설정                                 | 설명                                                                                 | 기본값 |
| ------------------------------------ | ------------------------------------------------------------------------------------ | ------ |
| `admin_gui_auth_password_complexity` | `admin_gui_auth = basic-auth`일 때 Kong Manager 비밀번호에 필요한 규칙을 정의합니다. | -      |

### 비밀번호 복잡성 규칙

#### 사전 설정 규칙

모든 `kong-preset` 값은 비밀번호가 다음 카테고리 중 최소 3개에서 문자를 포함하도록 요구합니다:

- 대문자 (A-Z)
- 소문자 (a-z)
- Base-10 숫자 (0-9)
- 특수 문자 (예: &, $, #, %)

**지원되는 사전 설정 규칙**:

- `min_8`: 최소 길이 8
- `min_12`: 최소 길이 12
- `min_20`: 최소 길이 20

**예시**:

```json
admin_gui_auth_password_complexity = { "kong-preset": "min_8" }
```

#### 사용자 정의 규칙

지원되는 키워드: `min`, `max`, `passphrase`

**예시**:

```json
admin_gui_auth_password_complexity = { "min": "disabled,24,11,9,8" }
```

## 세션 설정

| 설정                     | 설명                                                            | 기본값 |
| ------------------------ | --------------------------------------------------------------- | ------ |
| `admin_gui_session_conf` | Kong Manager에서 사용하는 Session 플러그인의 구성을 지정합니다. | -      |

**예시**:

```json
admin_gui_session_conf = {
  "cookie_name": "kookie",
  "secret": "changeme"
}
```

## UI 커스터마이징

### 헤더 설정

| 설정                         | 설명                                                                                                          | 기본값 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------- | ------ |
| `admin_gui_header_txt`       | Kong Manager 헤더 배너의 텍스트를 설정합니다. 이 구성이 비어 있으면 헤더 배너가 표시되지 않습니다.            | -      |
| `admin_gui_header_bg_color`  | Kong Manager 헤더 배너의 배경색을 설정합니다. CSS 색상 키워드, #-hexadecimal 또는 RGB 형식을 허용합니다.      | -      |
| `admin_gui_header_txt_color` | Kong Manager 헤더 배너의 텍스트 색상을 설정합니다. CSS 색상 키워드, #-hexadecimal 또는 RGB 형식을 허용합니다. | -      |

### 푸터 설정

| 설정                         | 설명                                                                                                          | 기본값 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------- | ------ |
| `admin_gui_footer_txt`       | Kong Manager 푸터 배너의 텍스트를 설정합니다. 이 구성이 비어 있으면 푸터 배너가 표시되지 않습니다.            | -      |
| `admin_gui_footer_bg_color`  | Kong Manager 푸터 배너의 배경색을 설정합니다. CSS 색상 키워드, #-hexadecimal 또는 RGB 형식을 허용합니다.      | -      |
| `admin_gui_footer_txt_color` | Kong Manager 푸터 배너의 텍스트 색상을 설정합니다. CSS 색상 키워드, #-hexadecimal 또는 RGB 형식을 허용합니다. | -      |

### 로그인 배너 설정

| 설정                           | 설명                                                 | 기본값 |
| ------------------------------ | ---------------------------------------------------- | ------ |
| `admin_gui_login_banner_title` | Kong Manager 로그인 배너의 제목 텍스트를 설정합니다. | -      |
| `admin_gui_login_banner_body`  | Kong Manager 로그인 배너의 본문 텍스트를 설정합니다. | -      |

**참고**: `admin_gui_login_banner_title`과 `admin_gui_login_banner_body`가 모두 비어 있으면 로그인 배너가 표시되지 않습니다.

## 고급 설정

### Kong Immunity 설정

| 설정              | 설명                                                                      | 기본값 |
| ----------------- | ------------------------------------------------------------------------- | ------ |
| `admin_gui_flags` | Admin GUI 레이아웃을 변경하여 Kong Immunity를 Admin GUI에서 활성화합니다. | `{}`   |

### 비밀번호 변경 제한 (최소 버전: 3.8)

| 설정                                      | 설명                                                                                                    | 기본값        | 최소 버전 |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------- | ------------- | --------- |
| `admin_gui_auth_change_password_attempts` | 사용자가 비밀번호를 변경할 수 있는 시도 횟수입니다. 0은 무제한 시도를 허용합니다.                       | `0`           | 3.8       |
| `admin_gui_auth_change_password_ttl`      | 비밀번호 변경 시도 기록의 TTL 길이(초)입니다. TTL보다 오래된 데이터베이스의 기록은 자동으로 제거됩니다. | `86400` (1일) | 3.8       |

### 로그인 시도 TTL (최소 버전: 3.9)

| 설정                                | 설명                                                                                             | 기본값         | 최소 버전 |
| ----------------------------------- | ------------------------------------------------------------------------------------------------ | -------------- | --------- |
| `admin_gui_auth_login_attempts_ttl` | 로그인 시도 기록의 TTL 길이(초)입니다. TTL보다 오래된 데이터베이스의 기록은 자동으로 제거됩니다. | `604800` (7일) | 3.9       |

**참고**: 이 인수는 0과 100000000 사이의 정수로 설정할 수 있습니다.

### CSP 헤더 설정 (최소 버전: 3.10)

| 설정                         | 설명                                                                                  | 기본값 | 최소 버전 |
| ---------------------------- | ------------------------------------------------------------------------------------- | ------ | --------- |
| `admin_gui_csp_header`       | Kong Manager에 대한 Content-Security-Policy (CSP) 헤더를 활성화하거나 비활성화합니다. | `off`  | 3.10      |
| `admin_gui_csp_header_value` | Kong Manager에 대한 Content-Security-Policy (CSP) 헤더의 값을 설정합니다.             | -      | 3.10      |

### Konnect CTA 숨기기 (최소 버전: 3.11)

| 설정                         | 설명                                                                                                               | 기본값 | 최소 버전 |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------ | --------- |
| `admin_gui_hide_konnect_cta` | Kong Manager의 모든 Konnect 호출 액션을 숨깁니다. 이 설정은 Kong Enterprise의 온프레미스 설치에만 관련이 있습니다. | `off`  | 3.11      |

## 색상 형식

### 지원되는 색상 형식

| 형식            | 예시                   | 설명               |
| --------------- | ---------------------- | ------------------ |
| CSS 색상 키워드 | `red`, `blue`, `green` | 표준 CSS 색상 이름 |
| #-hexadecimal   | `#FF0000`, `#00FF00`   | 16진수 색상 코드   |
| RGB             | `rgb(255, 0, 0)`       | RGB 색상 값        |

## 보안 고려사항

### SSL/TLS 보안

- **인증서 관리**: SSL 인증서를 안전하게 관리하세요
- **키 보안**: 개인 키를 안전한 위치에 저장하세요
- **프로토콜 버전**: 최신 TLS 버전을 사용하세요

### 인증 보안

- **강력한 비밀번호**: 복잡한 비밀번호 정책을 설정하세요
- **로그인 제한**: 무차별 대입 공격을 방지하기 위해 로그인 시도 제한을 설정하세요
- **세션 관리**: 안전한 세션 구성과 정기적인 세션 갱신을 설정하세요

### CSP 보안

- **CSP 헤더**: Content Security Policy를 활성화하여 XSS 공격을 방지하세요
- **CSP 값**: 필요에 따라 CSP 헤더 값을 사용자 정의하세요

## 운영 권장사항

### 모니터링

- **로그 모니터링**: Kong Manager 액세스 및 오류 로그를 정기적으로 검토하세요
- **성능 모니터링**: Kong Manager 응답 시간을 모니터링하세요
- **보안 모니터링**: 의심스러운 로그인 시도를 모니터링하세요

### 사용자 관리

- **접근 제어**: Kong Manager에 대한 접근을 제한하세요
- **사용자 교육**: 관리자에게 Kong Manager 사용법을 교육하세요
- **정기적 검토**: 사용자 권한을 정기적으로 검토하세요

### 백업 및 복구

- **구성 백업**: Kong Manager 구성을 정기적으로 백업하세요
- **인증서 백업**: SSL 인증서를 안전하게 백업하세요
- **재해 복구**: 재해 복구 절차를 정기적으로 테스트하세요
